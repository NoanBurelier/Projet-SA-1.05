<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <title>Rapport d'analyse du dump réseau</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<h1>Analyse du dump réseau</h1>
<h2>Attaque SYN sur le serveur HTTP</h2>
<ul>
<li>Nombre total de paquets SYN suspects : <strong>2000</strong></li>
<li>Seconde la plus chargée : <strong>15:34:06</strong> avec <strong>2000</strong> paquets SYN.</li>
<li>Source principale : <code>190-0-175-100.gba.solunet.com.ar</code> → Destination : <code>184.107.43.74</code> (HTTP).</li>
<li>Ce volume de SYN dans un temps très court est caractéristique d'une attaque de type <strong>SYN flood</strong>.</li>
</ul>
<h3>Répartition des SYN par seconde</h3>
<p>| Seconde | Nombre de SYN |
|---------|---------------|
| 15:34:06 | 2000 |</p>
<h2>Trafic HTTPS très volumineux</h2>
<ul>
<li>Nombre total de paquets HTTPS : <strong>2853</strong></li>
<li>Volume total estimé en HTTPS : <strong>157068 octets</strong></li>
<li>Ce trafic correspond à de nombreuses connexions HTTPS qui peuvent saturer le lien réseau.</li>
</ul>
<h3>Principaux couples IP en HTTPS</h3>
<p>| IP source | IP destination | Nombre de paquets |
|-----------|----------------|-------------------|
| BP-Linux8 | www.aggloroanne.fr | 1022 |
| BP-Linux8 | mauves.univ-st-etienne.fr | 751 |
| BP-Linux8 | par10s38-in-f3.1e100.net | 255 |
| BP-Linux8 | par21s23-in-f3.1e100.net | 200 |
| BP-Linux8 | par21s17-in-f1.1e100.net | 176 |</p>
<h2>Graphiques d'illustration</h2>
<ul>
<li>Graphique 1 : évolution du nombre de SYN par seconde.</li>
<li>Graphique 2 : top 5 couples IP source/destination en HTTPS.</li>
<li>Graphique 3 : top 5 IP source (volume global).</li>
<li>Graphique 4 : top 5 IP destination.</li>
<li>Graphique 5 : top 5 ports de destination.</li>
<li>Graphique 6 : top 5 protocoles/ports de destination.</li>
<li>Graphique 7 : trafic total (tous paquets) par seconde.</li>
</ul>

<h2>Graphique 1 : SYN par seconde</h2>
<canvas id="synChart" width="600" height="300"></canvas>

<h2>Graphique 2 : Top 5 couples HTTPS</h2>
<canvas id="httpsChart" width="600" height="300"></canvas>

<h2>Graphique 3 : Top 5 IP source</h2>
<canvas id="ipSrcChart" width="600" height="300"></canvas>

<h2>Graphique 4 : Top 5 IP destination</h2>
<canvas id="ipDstChart" width="600" height="300"></canvas>

<h2>Graphique 5 : Top 5 ports destination</h2>
<canvas id="portDstChart" width="600" height="300"></canvas>

<h2>Graphique 6 : Top 5 protocoles / ports de destination</h2>
<canvas id="protoChart" width="600" height="300"></canvas>

<h2>Graphique 7 : Trafic global par seconde</h2>
<canvas id="traficChart" width="600" height="300"></canvas>

<script>
// SYN
const synLabels = ['15:34:06'];
const synData = [2000];
const ctxSyn = document.getElementById('synChart').getContext('2d');
new Chart(ctxSyn, {
    type: 'bar',
    data: {
        labels: synLabels,
        datasets: [{
            label: 'Nombre de SYN',
            data: synData,
            backgroundColor: 'rgba(255, 99, 132, 0.5)',
            borderColor: 'rgba(255, 99, 132, 1)',
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            y: { beginAtZero: true }
        }
    }
});

// HTTPS pairs
const httpsLabels = ['BP-Linux8 → www.aggloroanne.fr', 'BP-Linux8 → mauves.univ-st-etienne.fr', 'BP-Linux8 → par10s38-in-f3.1e100.net', 'BP-Linux8 → par21s23-in-f3.1e100.net', 'BP-Linux8 → par21s17-in-f1.1e100.net'];
const httpsData = [1022, 751, 255, 200, 176];
const ctxHttps = document.getElementById('httpsChart').getContext('2d');
new Chart(ctxHttps, {
    type: 'bar',
    data: {
        labels: httpsLabels,
        datasets: [{
            label: 'Paquets HTTPS',
            data: httpsData,
            backgroundColor: 'rgba(54, 162, 235, 0.5)',
            borderColor: 'rgba(54, 162, 235, 1)',
            borderWidth: 1
        }]
    },
    options: {
        indexAxis: 'y',
        scales: {
            x: { beginAtZero: true }
        }
    }
});

// Top IP source
const ipSrcLabels = ['BP-Linux8', 'www.aggloroanne.fr', '190-0-175-100.gba.solunet.com.ar', 'mauves.univ-st-etienne.fr', 'par10s38-in-f3.1e100.net'];
const ipSrcData = [2968, 2130, 2000, 1687, 827];
const ctxIpSrc = document.getElementById('ipSrcChart').getContext('2d');
new Chart(ctxIpSrc, {
    type: 'bar',
    data: {
        labels: ipSrcLabels,
        datasets: [{
            label: 'Paquets émis',
            data: ipSrcData,
            backgroundColor: 'rgba(75, 192, 192, 0.5)',
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1
        }]
    },
    options: {
        indexAxis: 'y',
        scales: {
            x: { beginAtZero: true }
        }
    }
});

// Top IP destination
const ipDstLabels = ['BP-Linux8', '184.107.43.74', 'www.aggloroanne.fr', 'mauves.univ-st-etienne.fr', 'par10s38-in-f3.1e100.net'];
const ipDstData = [5798, 2000, 1022, 751, 255];
const ctxIpDst = document.getElementById('ipDstChart').getContext('2d');
new Chart(ctxIpDst, {
    type: 'bar',
    data: {
        labels: ipDstLabels,
        datasets: [{
            label: 'Paquets reçus',
            data: ipDstData,
            backgroundColor: 'rgba(255, 206, 86, 0.5)',
            borderColor: 'rgba(255, 206, 86, 1)',
            borderWidth: 1
        }]
    },
    options: {
        indexAxis: 'y',
        scales: {
            x: { beginAtZero: true }
        }
    }
});

// Top ports destination
const portDstLabels = ['https', 'http', '34862', '53324', '40682'];
const portDstData = [2853, 2055, 827, 499, 400];
const ctxPortDst = document.getElementById('portDstChart').getContext('2d');
new Chart(ctxPortDst, {
    type: 'bar',
    data: {
        labels: portDstLabels,
        datasets: [{
            label: 'Paquets vers le port',
            data: portDstData,
            backgroundColor: 'rgba(153, 102, 255, 0.5)',
            borderColor: 'rgba(153, 102, 255, 1)',
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            y: { beginAtZero: true }
        }
    }
});

// Top protocoles / ports
const protoLabels = ['https', 'http', '34862', '53324', '40682'];
const protoData = [2853, 2055, 827, 499, 400];
const ctxProto = document.getElementById('protoChart').getContext('2d');
new Chart(ctxProto, {
    type: 'bar',
    data: {
        labels: protoLabels,
        datasets: [{
            label: 'Paquets par port/proto',
            data: protoData,
            backgroundColor: 'rgba(255, 159, 64, 0.5)',
            borderColor: 'rgba(255, 159, 64, 1)',
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            y: { beginAtZero: true }
        }
    }
});

// Trafic global par seconde
const traficLabels = ['15:34:04', '15:34:06', '15:34:08', '15:34:09', '15:34:10', '15:34:11', '15:34:12', '15:34:13', '15:34:14', '15:34:15', '15:34:16', '15:34:17', '15:34:18', '15:34:19', '15:34:20', '15:34:21', '15:34:22', '15:34:23', '15:34:24', '15:34:25', '15:34:26', '15:34:27', '15:34:28', '15:34:29', '15:34:30', '15:34:31', '15:34:32', '15:34:33', '15:34:34', '15:34:35', '15:34:36', '15:34:37', '15:34:38', '15:34:39', '15:34:40', '15:34:41', '15:34:42', '15:34:43', '15:34:44', '15:34:45', '15:34:46', '15:34:47', '15:34:48', '15:34:49', '15:34:50', '15:34:51', '15:34:52', '15:34:53', '15:34:55'];
const traficData = [8, 2013, 2, 3, 34, 8, 21, 6, 2, 2, 2, 2, 4, 4, 4, 4, 427, 155, 36, 483, 91, 434, 90, 1812, 700, 294, 23, 2, 2, 4, 2, 2, 2, 6, 6, 16, 8, 153, 16, 129, 1151, 1141, 1210, 102, 111, 26, 6, 5, 2];
const ctxTrafic = document.getElementById('traficChart').getContext('2d');
new Chart(ctxTrafic, {
    type: 'line',
    data: {
        labels: traficLabels,
        datasets: [{
            label: 'Paquets totaux par seconde',
            data: traficData,
            fill: false,
            borderColor: 'rgba(0, 0, 0, 0.8)',
            tension: 0.1
        }]
    },
    options: {
        scales: {
            y: { beginAtZero: true }
        }
    }
});
</script>

</body>
</html>
